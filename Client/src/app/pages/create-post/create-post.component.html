<div class="create-post-container">
  <div class="create-post-card">
    <h2>Create New Property Listing</h2>
    
    <form (ngSubmit)="onSubmit()">
      <!-- Basic Information Section -->
      <div class="form-section">
        <h3>Basic Information</h3>
        
        <div class="form-group">
          <label for="title">Title*</label>
          <input 
            type="text" 
            id="title" 
            name="title" 
            [(ngModel)]="postData.title" 
            required
            placeholder="Enter property title"
          >
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="price">Price* ($)</label>
            <input 
              type="number" 
              id="price" 
              name="price" 
              [(ngModel)]="postData.price" 
              required
              placeholder="Enter price"
            >
          </div>
          
          <div class="form-group">
            <label for="type">Listing Type*</label>
            <select 
              id="type" 
              name="type" 
              [(ngModel)]="postData.type" 
              required
            >
              <option *ngFor="let type of postTypes" [value]="type">{{ type | titlecase }}</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="category">Category*</label>
            <select 
              id="category" 
              name="category" 
              [(ngModel)]="postData.category" 
              required
            >
              <option *ngFor="let category of categories" [value]="category">{{ category | titlecase }}</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="propertyType">Property Type*</label>
            <select 
              id="propertyType" 
              name="propertyType" 
              [(ngModel)]="postData.propertyType" 
              required
            >
              <option *ngFor="let propType of propertyTypes" [value]="propType">{{ propType | titlecase }}</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label for="description">Description*</label>
          <textarea 
            id="description" 
            name="description" 
            [(ngModel)]="postData.description" 
            required
            placeholder="Describe your property"
            rows="4"
          ></textarea>
        </div>
      </div>
      
      <!-- Location Section -->
      <div class="form-section">
        <h3>Location</h3>
        
        <div class="form-group">
          <label for="address">Address*</label>
          <input 
            type="text" 
            id="address" 
            name="address" 
            [(ngModel)]="postData.address" 
            required
            placeholder="Enter property address"
          >
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="city">City*</label>
            <input 
              type="text" 
              id="city" 
              name="city" 
              [(ngModel)]="postData.city" 
              required
              placeholder="Enter city"
            >
          </div>
        </div>
        
        <div class="form-row map-coordinates">
          <div class="form-group">
            <label for="latitude">Latitude*</label>
            <input 
              type="number" 
              id="latitude" 
              name="latitude" 
              [(ngModel)]="postData.latitude" 
              required
              placeholder="Enter latitude"
              step="0.000001"
              [readonly]="true"
            >
          </div>
          
          <div class="form-group">
            <label for="longitude">Longitude*</label>
            <input 
              type="number" 
              id="longitude" 
              name="longitude" 
              [(ngModel)]="postData.longitude" 
              required
              placeholder="Enter longitude"
              step="0.000001"
              [readonly]="true"
            >
          </div>
        </div>
        
        <div class="map-container">
          <p class="map-instructions"><i class="fas fa-info-circle"></i> Drag the marker to set the exact location of your property</p>
          <app-map 
            [latitude]="initialLatitude" 
            [longitude]="initialLongitude"
            [draggable]="true"
            (markerDragEnd)="onMarkerDragEnd($event)"
          ></app-map>
        </div>
      </div>
      
      <!-- Property Details Section -->
      <div class="form-section">
        <h3>Property Details</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label for="bedroom">Bedrooms*</label>
            <input 
              type="number" 
              id="bedroom" 
              name="bedroom" 
              [(ngModel)]="postData.bedroom" 
              required
              placeholder="Number of bedrooms"
              min="0"
            >
          </div>
          
          <div class="form-group">
            <label for="bathroom">Bathrooms*</label>
            <input 
              type="number" 
              id="bathroom" 
              name="bathroom" 
              [(ngModel)]="postData.bathroom" 
              required
              placeholder="Number of bathrooms"
              min="0"
            >
          </div>
          
          <div class="form-group">
            <label for="size">Size (sq ft)</label>
            <input 
              type="number" 
              id="size" 
              name="size" 
              [(ngModel)]="postData.postDetail.size" 
              placeholder="Property size"
              min="0"
            >
          </div>
        </div>
      </div>
      
      <!-- Additional Details Section -->
      <div class="form-section">
        <h3>Additional Details</h3>
        
        <div class="form-group">
          <label for="desc">Detailed Description*</label>
          <textarea 
            id="desc" 
            name="desc" 
            [(ngModel)]="postData.postDetail.desc" 
            required
            placeholder="Provide detailed information about your property"
            rows="4"
          ></textarea>
        </div>
        
        <div class="form-row">
          <div class="form-group utilities-group">
            <label>Utilities</label>
            <div class="utilities-checklist">
              <div class="utility-item" *ngFor="let utility of utilitiesOptions; let i = index">
                <label class="utility-checkbox">
                  <input 
                    type="checkbox" 
                    [id]="'utility-' + i"
                    [(ngModel)]="utility.checked"
                    [name]="'utility-' + i"
                  >
                  <span class="utility-icon"><i class="fas {{utility.icon}}"></i></span>
                  <span class="utility-name">{{utility.name}}</span>
                </label>
              </div>
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="pet">Pet Policy</label>
            <select 
              id="pet" 
              name="pet" 
              [(ngModel)]="postData.postDetail.pet"
              class="form-select"
            >
              <option value="" disabled selected>Select pet policy</option>
              <option *ngFor="let policy of petPolicyOptions" [value]="policy">{{policy}}</option>
            </select>
          </div>
        </div>
      </div>
      
      <!-- Image Upload Section -->
      <div class="form-section">
        <h3>Property Images</h3>
        
        <div class="form-group">
          <label for="images">Upload Images* (Max 5)</label>
          <input 
            type="file" 
            id="images" 
            name="images" 
            (change)="onImagesSelected($event)" 
            accept="image/*"
            multiple
            required
          >
        </div>
        
        <div class="image-preview" *ngIf="selectedImages && selectedImages.length > 0">
          <p>Selected files ({{ selectedImages.length }}):</p>
          <div class="image-thumbnails">
            <div class="image-thumbnail" *ngFor="let image of selectedImages; let i = index">
              <img [src]="getImagePreviewUrl(image, i)" alt="Preview">
              <button type="button" class="remove-image" (click)="removeImage(i)">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Error Message -->
      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>
      
      <!-- Submit Button -->
      <button type="submit" [disabled]="isLoading">
        {{ isLoading ? 'Creating Listing...' : 'Create Listing' }}
      </button>
    </form>
  </div>
</div>