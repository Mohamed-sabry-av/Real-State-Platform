<div class="singlePage">
    <div class="details">
        <div class="wrapper">
            @if (post | async; as p) {
            <app-slider [images]="p.images"></app-slider>
            <div class="info">
                @if (user | async; as u) {
                <div class="top">
                    <div class="post">
                        <div class="postTitle">
                            <h1>{{ p.title }}</h1>
                            <div class="address">
                                <img src="/images/pin.png" alt="" />
                                <span>{{ p.address }}, {{ p.city }}</span>
                            </div>
                            <h2 class="price">$ {{ p.price }}</h2>
                        </div>
                    </div>
                    <div class="user">
                        <img [src]="u.avatar ? getImageUrl(u.avatar) : '/images/default-avatar.svg'" alt="{{ u.name }}" />
                        <span class="name">{{ u.name }}</span>
                    </div>
                </div>
                <div class="bottom">
                    {{ p.description }}
                </div>
                }
            </div>
            }
        </div>
    </div>
    <div class="features">
        <div class="wrapper">
            @if (post | async; as p) {
            <!-- Owner Controls -->
            @if (isOwner) {
            <div class="owner-controls">
                <h3>Owner Controls</h3>
                <div class="action-buttons">
                    <button class="edit-btn" (click)="editPost()">
                        <i class="fa fa-edit"></i> Edit Post
                    </button>
                    <button class="delete-btn" (click)="deletePost()">
                        <i class="fa fa-trash"></i> Delete Post
                    </button>
                </div>
            </div>
            }

            <p class="title">General</p>
            <div class="listVertical">
                <div class="feature">
                    <img src="/images/utility.png" alt="">
                    <div class="featureText">
                        <span>Utilities</span>
                        <p>{{ p.postDetail?.utilities || 'Not specified' }}</p>
                    </div>
                </div>
                <div class="feature">
                    <img src="/images/pet.png" alt="">
                    <div class="featureText">
                        <span>Pets policy</span>
                        <p>{{ p.postDetail?.pet || 'Not specified' }}</p>
                    </div>
                </div>
                <div class="feature">
                    <img src="/images/fee.png" alt="">
                    <div class="featureText">
                        <span>Property Fees</span>
                        <p>{{ p.postDetail?.income ? 'Must have ' + p.postDetail.income + 'x the rent in total household
                            income' : 'Not specified' }}</p>
                    </div>
                </div>
            </div>
            <p class="title">Sizes</p>
            <div class="sizes">
                <div class="size">
                    <img src="/images/size.png" alt="">
                    <span>{{ p.postDetail?.size || 'N/A' }} sqft</span>
                </div>
                <div class="size">
                    <img src="/images/bed.png" alt="">
                    <span>{{ p.bedroom }} rooms</span>
                </div>
                <div class="size">
                    <img src="/images/bath.png" alt="">
                    <span>{{ p.bathroom }} bathroom</span>
                </div>
            </div>


            <p class="title">Nearby Places</p>
            <div class="listHorizontal">
                <div class="feature">
                    <img src="/images/school.png" alt="">
                    <div class="featureText">
                        <span>School</span>
                        <p>{{ p.postDetail?.school || 'Not specified' }}</p>
                    </div>
                </div>
                <div class="feature">
                    <img src="/images/bus.png" alt="">
                    <div class="featureText">
                        <span>Bus Stop</span>
                        <p>{{ p.postDetail?.bus || 'Not specified' }}</p>
                    </div>
                </div>
                <div class="feature">
                    <img src="/images/restaurant.png" alt="">
                    <div class="featureText">
                        <span>Restaurant</span>
                        <p>{{ p.postDetail?.utilities }}</p>
                    </div>
                </div>
            </div>
            <p class="title">Location</p>
            <div class="mapContainer">
                <app-map [latitude]="p.latitude" [longitude]="p.longitude"></app-map>
            </div>


            <div class="buttons">
                @if (!isOwner) {
                <button (click)="savePost()">
                    <img src="/images/save.png" alt="">
                    Save the place
                </button>
                <button>
                    <img src="/images/chat.png" alt="">
                    Contact the owner
                </button>
                }
            </div>
            }
        </div>
    </div>
</div>